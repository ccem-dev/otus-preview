!function(){"use strict";angular.module("otusjs.player.config",[])}(),function(){"use strict";angular.module("otusjs.player.component",[])}(),function(){"use strict";angular.module("otusjs.player.core",["otusjs.player.service"])}(),function(){"use strict";angular.module("otusjs.player.data",[])}(),function(){"use strict";angular.module("otusjs.player.viewer",[])}(),function(){"use strict";angular.module("otusjs.player.service",[])}(),function(){"use strict";angular.module("otusjs.player.standalone",["ngMaterial","ngMessages","ngAnimate","ui.router","angular-bind-html-compile","monospaced.mousewheel","otusjs.player.core","otusjs.player.component","otusjs.player.config","otusjs.player.data","otusjs.player.viewer","otusjs"])}(),function(){"use strict";function stateConfiguration($stateProvider,$urlRouterProvider,$locationProvider){$stateProvider.state("index",{url:"/index",templateUrl:"app/otusjs-player-viewer/sheet-view-template.html",resolve:{resolvedSurveyTemplate:function(FakeDataService,$q){var deferred=$q.defer();return FakeDataService.getSurveyTemplate().then(function(data){deferred.resolve(data)}),deferred.promise}},controller:"SheetViewController as sheetViewCtrl"}),$urlRouterProvider.otherwise("/index"),$locationProvider.html5Mode(!0)}angular.module("otusjs.player.config").config(stateConfiguration),stateConfiguration.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"]}(),function(){function themeConfiguration($mdThemingProvider,$mdIconProvider){$mdThemingProvider.theme("layoutTheme").primaryPalette("blue",{default:"A200","hue-1":"200","hue-2":"50","hue-3":"700"}).accentPalette("blue-grey",{default:"900","hue-1":"50"}).warnPalette("red"),$mdIconProvider.defaultIconSet("app/assets/icons/mdi.svg",24)}angular.module("otusjs.player.config").config(themeConfiguration),themeConfiguration.$inject=["$mdThemingProvider","$mdIconProvider"]}(),function(){"use strict";function OtusPreviewController(){var self=this;self.itemContainer=[],self.$onInit=function(){self.itemContainer=self.surveyTemplate.itemContainer}}angular.module("otusjs.player.component").component("otusPreview",{template:'<survey-item item-data="item" ng-repeat="item in ::$ctrl.itemStack track by $index"></survey-item>',controller:OtusPreviewController,bindings:{surveyTemplate:"<"}})}(),function(){"use strict";function FakeDataService($http,$q){function getSurveyTemplate(){var defer=$q.defer();return $http.get("app/otusjs-player-data/survey-template.json").success(function(data){defer.resolve(data)}).error(function(error){console.log("Cannot GET a fake survey template.")}),defer.promise}var self=this;self.getSurveyTemplate=getSurveyTemplate}angular.module("otusjs.player.data").service("FakeDataService",FakeDataService),FakeDataService.$inject=["$http","$q"]}(),function(){"use strict";function SheetViewController(resolvedSurveyTemplate){var self=this;self.surveyTemplate=resolvedSurveyTemplate}angular.module("otusjs.player.viewer").controller("SheetViewController",SheetViewController),SheetViewController.$inject=["resolvedSurveyTemplate"]}(),function(){"use strict";function directive(OtusButtonWidgetFactory){var ddo={scope:{click:"<"},templateUrl:"app/editor/ui/base/button/button.html",retrict:"E",link:function(scope,element,attrs){scope.widget=OtusButtonWidgetFactory.create(scope,attrs,scope.$parent.widget)}};return ddo}angular.module("otusjs.player.component").directive("otusButton",directive),directive.$inject=["OtusButtonWidgetFactory"]}(),function(){"use strict";function OtusButtonWidgetFactory(){function create(templateData,templateConfig,parentWidget){return new OtusButtonWidget(templateData,templateConfig,parentWidget)}var self=this;return self.create=create,self}function OtusButtonWidget(templateData,templateConfig,parentWidget){var self=this,validTooltipDirections=["top","bottom","left","right"];self.className=self.constructor.name,self.css={},self.template={},self.event={},self.template.ariaLabel=templateConfig.ariaLabel||templateConfig.label,self.template.label=templateConfig.label,self.template.tooltip=templateConfig.tooltip||templateConfig.label,self.template.tooltipDirection=void 0!==templateConfig.tooltipDirection&&validTooltipDirections.indexOf(templateConfig.tooltipDirection)!==-1?templateConfig.tooltipDirection:"top",self.template.leftIcon=templateConfig.iconButton||templateConfig.leftIcon,self.template.rightIcon=templateConfig.rightIcon,self.template.hasLeftIcon=void 0!==self.template.leftIcon,self.template.hasRightIcon=void 0===templateConfig.iconButton&&void 0!==self.template.rightIcon,self.css.iconButton=void 0!==templateConfig.iconButton?"md-icon-button":"",self.parent=parentWidget,self.event.click=templateData.click}angular.module("otusjs.player.component").factory("OtusButtonWidgetFactory",OtusButtonWidgetFactory)}(),function(){"use strict";function OtusCommentController(){var self=this;self.update=function(){self.onUpdate({valueType:"comment",value:self.comment})}}angular.module("otusjs.player.component").component("otusComment",{templateUrl:"app/otusjs-player-component/comment/comment-template.html",controller:OtusCommentController,bindings:{itemData:"<",onUpdate:"&"}})}(),function(){"use strict";function otusInputText(OtusInputTextWidgetFactory){var ddo={scope:{model:"<",disabled:"@"},templateUrl:"app/editor/ui/base/input-text/input-text.html",retrict:"E",link:function(scope,element,attrs){scope.widget=OtusInputTextWidgetFactory.create(scope,attrs,element,scope.$parent.widget||scope.$parent.$parent.childWidget)}};return ddo}angular.module("otusjs.player.component").directive("otusInputText",otusInputText),otusInputText.$inject=["OtusInputTextWidgetFactory"]}(),function(){"use strict";function OtusInputTextWidgetFactory(){function create(templateData,templateConfig,element,parentWidget){return new OtusInputTextWidget(templateData,templateConfig,element,parentWidget)}var self=this;return self.create=create,self}function OtusInputTextWidget(templateData,templateConfig,element,parentWidget){var self=this;self.className=self.constructor.name,self.css={},self.template={},self.event={},self.template.ariaLabel=templateConfig.ariaLabel||templateConfig.label,self.template.label=templateConfig.label,self.template.leftIcon=templateConfig.iconButton||templateConfig.leftIcon,self.template.rightIcon=templateConfig.rightIcon,self.template.hasLeftIcon=void 0!==self.template.leftIcon,self.template.hasRightIcon=void 0===templateConfig.iconButton&&void 0!==self.template.rightIcon,self.parent=parentWidget,self.modelReference=templateData.model,self.style=templateData.style,templateData.model instanceof Function?self.model=templateData.model():self.model=templateData.model,element.on("change",function(){self.modelReference instanceof Function?self.modelReference(self.model):self.modelReference=self.model})}angular.module("otusjs.player.component").factory("OtusInputTextWidgetFactory",OtusInputTextWidgetFactory)}(),function(){"use strict";function LabelController($element){function _fillLabel(){$element[0].innerHTML=_getLabel()}function _getLabel(){return self.itemLabel instanceof Object?self.itemLabel.ptBR.formattedText:self.itemLabel}var self=this;self.$onInit=function(){_fillLabel()}}angular.module("otusjs.player.component").component("otusLabel",{controller:LabelController,bindings:{itemLabel:"<"}}),LabelController.$inject=["$element"]}(),function(){"use strict";function MetadataGroupController(){var self=this;self.update=function(){self.onUpdate({valueType:"metadata",value:self.metadata})}}angular.module("otusjs.player.component").component("metadataGroup",{templateUrl:"app/otusjs-player-component/metadata/metadata-group-template.html",controller:MetadataGroupController,bindings:{itemData:"<",onUpdate:"&"}})}(),function(){"use strict";function AnchorController($element,PageAnchorService){var self=this;self.$onInit=function(){$element.attr("tabindex",-1),PageAnchorService.anchorRegistry($element)}}angular.module("otusjs.player.component").component("otusPageAnchor",{templateUrl:"app/editor/ui/page-anchor-item/page-anchor-template.html",controller:AnchorController,bindings:{id:"<"}}),AnchorController.$inject=["$element","PageAnchorService"]}(),function(){function PageAnchorService(){function anchorRegistry(anchorElement){anchorList[anchorElement[0].id]=anchorElement}function sheetAutoFocus(sheet){var childrenNb=sheet.children().length;childrenNb>6?_focusOnBottom():_focusOnTop()}function _focusOnTop(){anchorList["top-anchor"].focus()}function _focusOnBottom(){anchorList["bottom-anchor"].focus()}var self=this,anchorList={};self.sheetAutoFocus=sheetAutoFocus,self.anchorRegistry=anchorRegistry}angular.module("otusjs.player.component").service("PageAnchorService",PageAnchorService)}(),function(){"use strict";function OtusSheetController($scope,$element,$compile,PlayerService,DataService){function onInit(){self.isLoading=!0,PlayerService.play(self.surveyTemplate.itemContainer),nextItem()}function onDestroy(){_clearWorspace()}function previousItem(){PlayerService.hasPrevious()&&(loadItem(PlayerService.getPrevious()),updateToolbar(),self.currentChild&&destroyCurrentItem())}function nextItem(){PlayerService.hasNext()&&(loadItem(PlayerService.getNext()),updateToolbar(),self.currentChild&&(transferData(),destroyCurrentItem()))}function loadItem(item){$scope.itemData=item,$element.find("section").prepend($compile(SURVEY_ITEM)($scope))}function updateToolbar(){self.isPreviousDisabled=!PlayerService.hasPrevious(),self.isNextDisabled=!PlayerService.hasNext()}function transferData(){DataService.transferData(self.currentChild.filling)}function destroyCurrentItem(){self.currentChild.destroy()}function catchMouseWheel($event){event.deltaY>0?nextItem():previousItem()}function _clearWorspace(){WorkspaceService.closeWork(),$window.sessionStorage.removeItem("surveyTemplate_OID")}var self=this,SURVEY_ITEM='<otus-survey-item item-data="itemData" />';self.$onInit=onInit,self.$onDestroy=onDestroy,self.previousItem=previousItem,self.nextItem=nextItem,self.catchMouseWheel=catchMouseWheel}angular.module("otusjs.player.component").component("otusSheet",{templateUrl:"app/otusjs-player-component/sheet/sheet-template.html",controller:OtusSheetController,bindings:{surveyTemplate:"<"}}),OtusSheetController.$inject=["$scope","$element","$compile","otusjs.player.core.PlayerService","DataService"]}(),function(){"use strict";function OtusSurveyHeaderController(){}angular.module("otusjs.player.component").component("otusSurveyHeader",{templateUrl:"app/otusjs-player-component/survey-header/survey-header-template.html",controller:OtusSurveyHeaderController,bindings:{surveyIdentity:"<"}})}(),function(){"use strict";function OtusSurveyItemController($scope,$element){function isQuestion(){return"ImageItem"!==self.itemData.objectType&&"TextItem"!==self.itemData.objectType}function isItem(){return"ImageItem"===self.itemData.objectType||"TextItem"===self.itemData.objectType}function restoreAll(){console.log(self.itemData)}function update(prop,value){self.filling[prop]=value}function destroy(){$element.remove(),$scope.$destroy()}var self=this;self.isQuestion=isQuestion,self.isItem=isItem,self.restoreAll=restoreAll,self.update=update,self.destroy=destroy,self.$onInit=function(){self.filling={},self.filling.questionID=self.itemData.templateID,self.otusSheet.currentChild=self}}angular.module("otusjs.player.component").component("otusSurveyItem",{templateUrl:"app/otusjs-player-component/survey-item/survey-item-template.html",controller:OtusSurveyItemController,require:{otusSheet:"^"},bindings:{itemData:"<"}}),OtusSurveyItemController.$inject=["$scope","$element"]}(),function(){"use strict";function directive(OtusTextEditorWidgetFactory){var ddo={scope:{placeholder:"@",label:"<",ariaLabel:"@",leftIcon:"@",ngModel:"<"},templateUrl:"app/editor/ui/base/text-editor/text-editor.html",retrict:"E",link:function(scope,element){scope.widget=OtusTextEditorWidgetFactory.create(scope,element)}};return ddo}angular.module("otusjs.player.component").directive("otusTextEditor",directive),directive.$inject=["OtusTextEditorWidgetFactory"]}(),function(){"use strict";function OtusTextEditorWidgetFactory(UpdateQuestionEventFactory){function create(scope,element){return new OtusTextEditorWidget(scope,element,UpdateQuestionEventFactory)}var self=this;return self.create=create,self}function OtusTextEditorWidget(scope,element,UpdateQuestionEventFactory){function _init(){self.ngModel&&_loadLabel()}function getClassName(){return"OtusTextEditorWidget"}function getUUID(){return scope.uuid}function getLabel(){return self.ngModel.ptBR.formattedText}function getElement(){return element}function getParent(){return scope.$parent.widget}function getItem(){return getParent().getItem()}function _saveLabel(){self.ngModel.ptBR.formattedText=_removeSpecialCharacters(event.target.innerHTML),self.ngModel.ptBR.plainText=event.target.innerText}function _removeSpecialCharacters(value){return value.replace(/"/g,"'")}function _loadLabel(){self.getElement().children()[0].innerHTML=self.getLabel()}var self=this;self.input=angular.element(element.children()[0]),self.ngModel=scope.ngModel,self.placeholder=scope.placeholder,self.getClassName=getClassName,self.getUUID=getUUID,self.getElement=getElement,self.getParent=getParent,self.getItem=getItem,self.getLabel=getLabel,_init(),element.on("focusout",function(event){_saveLabel(),UpdateQuestionEventFactory.create().execute(self)})}angular.module("otusjs.player.component").factory("OtusTextEditorWidgetFactory",OtusTextEditorWidgetFactory),OtusTextEditorWidgetFactory.$inject=["UpdateQuestionEventFactory"]}(),function(){"use strict";function ItemManagerService(){function init(items){_items=items,_currentItemIndex=-1,_updateIterator()}function getItems(){return _items}function getCurrentItem(){return _currentItem}function hasNext(){return!!_hasNext}function hasPrevious(){return!!_hasPrevious}function next(){return++_currentItemIndex,_updateIterator(),_currentItem}function previous(){return--_currentItemIndex,_updateIterator(),_currentItem}function _updateIterator(){_hasNext=_items[_currentItemIndex+1],_hasPrevious=_items[_currentItemIndex-1],_currentItem=_items[_currentItemIndex]}var self=this,_items=[],_currentItemIndex=null,_currentItem=null,_hasNext=null,_hasPrevious=null;self.init=init,self.getItems=getItems,self.getCurrentItem=getCurrentItem,self.hasNext=hasNext,self.hasPrevious=hasPrevious,self.next=next,self.previous=previous}angular.module("otusjs.player.core").service("otusjs.player.core.ItemManagerService",ItemManagerService)}(),function(){"use strict";function PlayerService(ItemManagerService){function play(items){ItemManagerService.init(items)}function getNext(){if(hasNext())return ItemManagerService.next()}function getPrevious(){if(hasPrevious())return ItemManagerService.previous()}function hasNext(){return ItemManagerService.hasNext()}function hasPrevious(){return ItemManagerService.hasPrevious()}var self=this;self.play=play,self.getNext=getNext,self.getPrevious=getPrevious,self.hasNext=hasNext,self.hasPrevious=hasPrevious}angular.module("otusjs.player.core").service("otusjs.player.core.PlayerService",PlayerService),PlayerService.$inject=["otusjs.player.core.ItemManagerService"]}(),function(){"use strict";function DataService(ActivityFacadeService,ActivityUserFactory){function transferData(data){var user=ActivityUserFactory.create("User Name","user@email.com");ActivityFacadeService.createActivity("category","group","FOR123",user),ActivityFacadeService.createQuestionFill(data.questionID,data.answer,data.metadata,data.comment)}var self=this;self.transferData=transferData}angular.module("otusjs.player.service").service("DataService",DataService),DataService.$inject=["ActivityFacadeService","ActivityUserFactory"]}(),function(){"use strict";function HtmlBuilderService(){function generateTagName(stringToFormat){var chars=stringToFormat.split(""),tagName="";return chars.forEach(function(character,index){var lowerChar="";character===character.toUpperCase()?(lowerChar=character.toLowerCase(),0!==index&&(lowerChar="-"+lowerChar)):lowerChar=character,tagName+=lowerChar}),tagName}var self=this;self.generateTagName=generateTagName}angular.module("otusjs.player.service").service("HtmlBuilderService",HtmlBuilderService)}(),function(){"use strict";function TagComponentBuilderService(HtmlBuilderService){function createTagElement(elementType){return _replace(HtmlBuilderService.generateTagName(elementType))}function _replace(tagName){return"<otus-"+tagName+' item-data="$ctrl.itemData" on-update="$ctrl.update(valueType, value)" />'}var self=this;self.createTagElement=createTagElement}angular.module("otusjs.player.service").service("TagComponentBuilderService",TagComponentBuilderService),TagComponentBuilderService.$inject=["HtmlBuilderService"]}(),function(){"use strict";function OtusMiscItemController(){function isImageItem(){return"ImageItem"===self.itemData.objectType}function isTextItem(){return"TextItem"===self.itemData.objectType}var self=this;self.isImageItem=isImageItem,self.isTextItem=isTextItem,self.$onInit=function(){}}angular.module("otusjs.player.component").component("otusMiscItem",{templateUrl:"app/otusjs-player-component/survey-item/misc/misc-item-template.html",controller:OtusMiscItemController,bindings:{itemData:"<"}})}(),function(){"use strict";function OtusQuestionController(TagComponentBuilderService){var self=this;self.$onInit=function(){self.template=TagComponentBuilderService.createTagElement(self.itemData.objectType)},self.update=function(prop,value){self.onUpdate({valueType:prop,value:value})}}angular.module("otusjs.player.component").component("otusQuestion",{templateUrl:"app/otusjs-player-component/survey-item/question/question-component-template.html",controller:OtusQuestionController,bindings:{itemData:"<",onUpdate:"&"},require:{otusSurveyItem:"^otusSurveyItem"}}),OtusQuestionController.$inject=["TagComponentBuilderService"]}(),function(){"use strict";function ImageItemController(){var self=this;self.$onInit=function(){}}angular.module("otusjs.player.component").component("otusImageItem",{templateUrl:"app/otusjs-player-component/survey-item/misc/image/image-item-template.html",controller:ImageItemController,bindings:{itemData:"<"}})}(),function(){"use strict";function TextItemController(){var self=this;self.$onInit=function(){}}angular.module("otusjs.player.component").component("otusTextItem",{templateUrl:"app/otusjs-player-component/survey-item/misc/text/text-item-template.html",controller:TextItemController,bindings:{itemData:"<"}})}(),function(){"use strict";function OtusCalendarQuestionController(){var self=this;self.update=function(){self.onUpdate({valueType:"answer",value:self.answer})}}angular.module("otusjs.player.component").component("otusCalendarQuestion",{templateUrl:"app/otusjs-player-component/survey-item/question/calendar/calendar-question-template.html",controller:OtusCalendarQuestionController,bindings:{itemData:"<",onUpdate:"&"}})}(),function(){"use strict";function CheckboxQuestionController(){function _buildAnswerObject(index,value){return{valueType:"answer",value:{option:index,state:value}}}var self=this;self.$onInit=function(){self.answerArray=[],self.itemData.options.forEach(function(option){self.answerArray.push(_buildAnswerObject(option.value,!1))})},self.update=function(){self.onUpdate({value:self.answerArray})}}angular.module("otusjs.player.component").component("otusCheckboxQuestion",{templateUrl:"app/otusjs-player-component/survey-item/question/checkbox/checkbox-question-template.html",controller:CheckboxQuestionController,bindings:{itemData:"<",onUpdate:"&"}})}(),function(){"use strict";function DecimalQuestionController(){var self=this;self.update=function(){self.onUpdate({valueType:"answer",value:self.answer})}}angular.module("otusjs.player.component").component("otusDecimalQuestion",{templateUrl:"app/otusjs-player-component/survey-item/question/decimal/decimal-question-template.html",controller:DecimalQuestionController,bindings:{itemData:"<",onUpdate:"&"}})}(),function(){"use strict";function EmailQuestionController($element){var self=this;self.update=function(){self.onUpdate({valueType:"answer",value:self.answer})},self.ariaLabel=function(){return self.itemData.label.ptBR.plainText}}angular.module("otusjs.player.component").component("otusEmailQuestion",{templateUrl:"app/otusjs-player-component/survey-item/question/email/email-question-template.html",controller:EmailQuestionController,bindings:{itemData:"<",onUpdate:"&"}}),EmailQuestionController.$inject=["$element"]}(),function(){"use strict";function IntegerQuestionController(){var self=this;self.update=function(){self.onUpdate({valueType:"answer",value:self.answer})}}angular.module("otusjs.player.component").component("otusIntegerQuestion",{templateUrl:"app/otusjs-player-component/survey-item/question/integer/integer-question-template.html",controller:IntegerQuestionController,bindings:{itemData:"<",onUpdate:"&"}})}(),function(){"use strict";angular.module("otusjs.player.component").directive("uiInteger",function(){return{link:function($scope,element,attrs,ngModelCtrl){function shouldPrintChar(event){var keycode=(angular.element(event.currentTarget),event.which);return isNumberKey(keycode)||isValidKey(keycode)}function formatedInteger(event){var element=angular.element(event.currentTarget),keycode=event.which,currentValue=element.val();0===currentValue.length?lastValidValue="":isNumberKey(keycode)||isValidKey(keycode)?lastValidValue=element.val():isValidKey(keycode)||element.val(lastValidValue)}function isNumberKey(keycode){return keycode>=48&&keycode<=57||keycode>=96&&keycode<=105}function isValidKey(keycode){var minusKey=109===keycode,shiftKey=16===keycode,backspaceKey=8===keycode,homeKey=36===keycode,endKey=35===keycode,deleteKey=46===keycode,controlKey=17===keycode,leftKey=37===keycode,rightKey=39===keycode;return minusKey||shiftKey||backspaceKey||homeKey||endKey||deleteKey||controlKey||leftKey||rightKey}var lastValidValue;element.on("keydown",shouldPrintChar),element.on("keyup",formatedInteger)}}})}(),function(){"use strict";function PhoneQuestionController(){var self=this;self.update=function(){self.onUpdate({valueType:"answer",value:self.answer})}}angular.module("otusjs.player.component").component("otusPhoneQuestion",{templateUrl:"app/otusjs-player-component/survey-item/question/phone/phone-question-template.html",controller:PhoneQuestionController,bindings:{itemData:"<",onUpdate:"&"}})}(),function(){"use strict";function SingleSelectionQuestionController(){var self=this;self.update=function(){self.onUpdate({valueType:"answer",value:self.answer})}}angular.module("otusjs.player.component").component("otusSingleSelectionQuestion",{templateUrl:"app/otusjs-player-component/survey-item/question/single-selection/single-selection-question-template.html",controller:SingleSelectionQuestionController,bindings:{itemData:"<",onUpdate:"&"}})}(),function(){"use strict";function TextQuestionController(){var self=this;self.update=function(){self.onUpdate({valueType:"answer",value:self.answer})}}angular.module("otusjs.player.component").component("otusTextQuestion",{templateUrl:"app/otusjs-player-component/survey-item/question/text/text-question-template.html",controller:TextQuestionController,bindings:{itemData:"<",onUpdate:"&"}})}(),function(){"use strict";function TimeQuestionController(){var self=this;self.update=function(){self.onUpdate({valueType:"answer",value:self.answer})}}angular.module("otusjs.player.component").component("otusTimeQuestion",{templateUrl:"app/otusjs-player-component/survey-item/question/time/time-question-template.html",controller:TimeQuestionController,bindings:{itemData:"<",onUpdate:"&"}})}();